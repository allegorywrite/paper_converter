60 Questions & Answers

ver. 25.03

## ０．前提・アブストラクト / Prerequisites and Abstract（0/4完了, 0/4英語化）

▲0-1. paper skeletonへのリンクを示し、内容を完成させよ / Link to the paper skeleton of the paper

https://docs.google.com/document/d/paper-skeleton-link

▲0-2. 【毎年１冊以上】 論文の書き方について読んだ書籍をすべて挙げよ。/ List the books you have read on how to write scientific papers

- 「理科系の作文技術」木下是雄著、中央公論社
- 「英語論文の書き方入門」杉原厚吉著、日本評論社
- 「科学技術論文の書き方」酒井聡樹著、共立出版

▲0-3. 【初回英語論文のみ】 以下を実行せよ / (Skip this item)

以下をコピーし、リンクを貼り替えてから回答せよ

英語論文執筆テスト22（問題編）直接編集不可。コピーして使ってください

「論文英語化」でgdriveを検索して、zoom録画を視聴せよ

https://drive.google.com/file/d/1UirxW4Z6fGmHy_1LNmPLhMeOfC1ZA-kX/view?usp=sharing

https://drive.google.com/file/d/1tL08Dt5uQklhe1627mTs32c2LoxVoV4i/view?usp=sharing

https://drive.google.com/file/d/1ZFi8wT31T81Y7nRt5ERbRIYfiuRqKL0y/view?usp=sharing

▲0-4. 各節から文をピックアップしてアブストラクトを作成せよ / Pick sentences from each section and integrate them as an abstract

農地や森林など単調かつ広大な野外環境下では、誤差の蓄積と外れ値の影響により画像のマッチングによる大域の自己位置推定が十分に機能しない。特に複数のエージェントによる協調推定においては、各エージェントの誤った状態推定が全エージェントに影響する為、各エージェントの外れ値割合に伴ってシステム全体が誤った推定をする確率は指数関数的に上昇する。本研究では、Stein Particle Filterを用いることで、従来の画像特徴量のマッチングに位置情報による尤度を考慮しつつ、複数のエージェント間で推定状態を合意するVINS手法を提案する。提案手法は、複数エージェント間の合意制約と多峰性分布の扱いを同時に可能にし、従来手法では困難であった外れ値混在環境下での安定的な位置合意を実現する。シミュレーションおよび実機実験（単機）結果から、SPFを用いることによって、分布近似と勾配情報を活用し、既存手法よりもロバストかつ柔軟な自己位置推定が可能であることが示された。Our code and dataset are available at this URL.

## １．はじめに・序論 / Introduction（0/10完了, 0/10英語化）

▲1-1. 本研究の社会的背景は何か？ / What is the social background?

多くの自律移動可能なロボットは、動作の基盤となる自己位置推定を必要とする。自律移動ロボットの社会への浸透に伴って、過酷環境や山間地域等GPS/GNSSが利用できない環境での自己位置推定技術が数多く研究されている。特に近年では、交通環境・日常生活環境・過酷環境等あらゆる領域で自律ロボットの導入が進んでおり、複数のエージェントが同時に動作するマルチエージェント環境が主要な研究分野となっている。GPS/GNSSが使用できない過酷環境や山間地域においても、システム全体としての対故障性やそれぞれの目的におけるスケーラビリティの観点から、いくつかの研究でマルチエージェントによる協調作業が試みられている。

▲1-2. 本研究のtarget task/problemは何か？ / What is the target problem of this study?

本研究のターゲット問題は、GPS/GNSSが利用できない単調かつ広大な野外環境（農地や森林など）における複数UAVの協調自己位置推定である。このような環境では、誤差の蓄積と外れ値の影響により、従来の画像マッチングによる大域の自己位置推定が十分に機能しない。特に複数のエージェントによる協調推定においては、各エージェントの誤った状態推定が全エージェントに影響するため、外れ値の割合に伴ってシステム全体が誤った推定をする確率が指数関数的に上昇するという問題がある。

▲1-3. 本研究のtarget problemの具体例（ユースケース）は何か？ / Explain a typical use case.

農業用ドローンの群れが広大な農地で作物の生育状況をモニタリングする場面を考える。このような環境では、作物の見た目が似通っており、地形的特徴も乏しいため、画像マッチングによる自己位置推定が困難である。各ドローンは自身のカメラとIMUを用いて位置を推定し、他のドローンと情報を共有することで協調的に自己位置を推定する必要がある。しかし、一部のドローンが誤った位置推定をした場合、その誤情報が他のドローンにも伝播し、システム全体の位置推定精度が低下する可能性がある。本研究の手法は、このような状況でも安定した自己位置推定を実現する。

▲1-4. そのtarget problemが難しいと言う根拠は何か？既存手法が誤る例はどんなケースか？ / Why is this task challenging? Explain typical failure cases of existing methods.

単調環境における協調自己位置推定が難しい根拠は、主に以下の点にある。まず、単調な環境では類似した視覚的特徴が多く存在するため、画像マッチングによる位置推定が誤りやすい。例えば、農地や森林では似たような景観が繰り返し現れるため、特徴点の対応付けが曖昧になりやすい。また、複数エージェントの協調推定では、一つのエージェントの誤った推定が他のエージェントにも影響を及ぼす。既存のグラフ最適化ベースの手法（例：D2SLAM）では、誤ったマッチング（外れ値）が存在する場合、最適化が破綻してしまう。具体的には、単調環境において類似画像のマッチングが機能せず、ポーズグラフ上で誤ったマッチングが行われることで、最適化の結果、誤った内分点が選ばれてしまうケースがある。

▲1-5. 既存手法群には何が不足しているのか？ / Why are conventional studies insufficient?

既存の協調自己位置推定手法は、主にグラフ最適化ベースのアプローチを採用しており、D2SLAMなどの手法がトップ性能を示している。しかし、これらの手法は根本的に多峰性の強い問題に対処できないという限界がある。単調環境では、複数の異なる位置が同様の観測を生成する可能性があり、これは確率分布上で複数のピーク（多峰性）として現れる。グラフ最適化ベースの手法は、このような多峰性分布を適切に表現・処理できず、単一の最適解を求めようとするため、外れ値が存在する場合に推定が破綻しやすい。また、既存手法では複数エージェント間の合意制約と多峰性分布の扱いを同時に考慮する枠組みが不足している。

▲1-6. 本研究では何を提案し、何を解決するのか？ / What is proposed and solved in this study?

そこで、本研究では、Stein Particle Filterを用いた協調Visual Inertial System（CoVINS）手法を提案する。この手法は、従来の画像特徴量のマッチングに位置情報による尤度を考慮しつつ、複数のエージェント間で推定状態を合意するVINS手法である。具体的には、Stein Particle FilterとRelaxed ADMMを組み合わせた新たなフレームワークを提案し、単調な広域環境におけるUAVの協調自己位置推定問題に取り組む。これにより、複数エージェント間の合意制約と多峰性分布の扱いを同時に可能にし、従来手法では困難であった外れ値混在環境下での安定的な位置合意を実現する。

▲1-7. 提案手法は既存手法と何が違うのか？主要な違い１点 or ２点に絞って述べよ。 / What is the main difference between the proposed and conventional methods?

提案手法の主要な違いは、確率分布の状態での協調自己位置推定を実現する点にある。具体的には、パーティクルフィルタを用いることで、正しいエッジと誤ったエッジによって生成され得る複数のグラフを同時に探索できる。これにより、単調環境及び多峰性の強い環境でも推定可能な曖昧表現性を獲得している。従来のグラフ最適化ベースの手法では、単一の最適解を求めるため、外れ値が存在する場合に推定が破綻しやすかったが、提案手法では確率分布をパーティクル集合によって表現し、それらをStein Variational Gradient Descent（SVGD）に基づく勾配法で更新することで、多峰性分布を適切に処理できる。

▲1-8. 提案既存手法との違う部分は、なぜ導入するべきなのか？なぜ導入するとうまくいくと予想されるのか？ / Explain why the difference should be introduced.

確率分布の状態での協調自己位置推定を導入する理由は、単調環境における多峰性の問題に対処するためである。単調環境では、複数の異なる位置が同様の観測を生成する可能性があり、これは確率分布上で複数のピークとして現れる。従来のグラフ最適化ベースの手法では、単一の最適解を求めるため、外れ値が存在する場合に推定が破綻しやすい。一方、パーティクルフィルタを用いた確率分布の表現は、このような多峰性分布を適切に表現・処理できる。さらに、Stein Variational Gradient Descent（SVGD）を用いることで、パーティクル分布を滑らかに変形させ、目標分布へと収束させることができる。これにより、リサンプリングによるパーティクル劣化の問題も回避できる。また、Relaxed ADMMを組み合わせることで、複数エージェント間の合意制約も同時に考慮できる。

▲1-9. 提案手法の新規性は何か？箇条書きせよ。 / What is the novelty of the proposed method?

- Relaxed ADMMを用いたStein Particle Filterの合意問題を定式化し、強力な曖昧表現性を有する協調的な自己位置推定手法を提案
- 6自由度姿勢空間における協調最適化手法の定式化により、CoVINSなど現実環境のシステムに適用できる位置推定手法を実現
- 階層型尤度を導入し、広域ではNetVLAD特徴量、局所ではSuperpoint特徴量を用いることで、単調環境における特徴マッチングの精度を向上
- GPUの利用により、複数機の大量パーティクルを同時に並列計算できるアルゴリズムを実現

▲1-10. 【査読がある会議のみ】提案手法全体の構成をeye-catch figureを用いて示せ（通常6回修正ののち確定） / Show the eye-catch figure.

[ここにeye-catch figureを挿入]

## ２．関連研究 / Related Work（0/6完了, 0/6英語化）

▲2-1. サーベイ論文を挙げて、本研究の関連分野群を概説せよ。 / Explain about the related areas by presenting multiple survey (or representative) papers.

本研究は主に以下の関連分野に関連している。

まず、Visual Inertial System（VINS）に関する研究分野がある。VINSはカメラとIMU（慣性計測ユニット）を組み合わせて自己位置推定を行う手法であり、GPS/GNSSが利用できない環境での自己位置推定に広く用いられている。Qin et al. [1]はVINS-Monoという単眼カメラとIMUを用いたロバストで汎用性の高いVINSを提案しており、この分野の代表的な研究である。

次に、マルチロボット協調SLAM（Simultaneous Localization and Mapping）の分野がある。Chen et al. [2]はデータ融合の観点からマルチロボット協調SLAMの概要をまとめており、様々なアプローチを分類・比較している。また、Zhou et al. [3]は実際の野外環境でのマイクロ飛行ロボットの群れに関する研究を行っており、実世界での協調自己位置推定の課題と解決策を示している。

さらに、パーティクルフィルタと変分推論に関する研究分野がある。Liu and Wang [4]はStein Variational Gradient Descent（SVGD）という一般的なベイズ推論アルゴリズムを提案しており、これは本研究で用いるStein Particle Filterの基礎となっている。また、Koide et al. [5]はGPUを用いたStein Particle Filterの高速化に関する研究を行っており、実時間での6自由度位置推定を実現している。

▲2-2. 論文を複数挙げて、１個目の関連分野を説明せよ / Explain the first related subfield and several related papers

Visual Inertial System（VINS）は、カメラとIMU（慣性計測ユニット）を組み合わせて自己位置推定を行う手法であり、GPS/GNSSが利用できない環境での自己位置推定に広く用いられている。Qin et al. [1]はVINS-Monoという単眼カメラとIMUを用いたロバストで汎用性の高いVINSを提案しており、特徴点追跡、IMUの事前積分、ループ検出などの機能を統合している。Bloesch et al. [6]は直接的な光度フィードバックを用いた拡張カルマンフィルタベースのVINSを提案しており、特徴点抽出に依存しない手法を実現している。Forster et al. [7]はマニフォールド上での事前積分を用いたリアルタイムVINSを提案しており、IMUの測定値を効率的に処理する方法を示している。これらの研究は単一のエージェントに焦点を当てており、複数エージェントの協調や単調環境での課題には十分に対応していない。

▲2-3. 論文を複数挙げて、N個目の関連分野を説明せよ（この項目を個数分コピーしてください） / Explain the N-th related subfield and several related papers

マルチロボット協調SLAMは、複数のロボットが協力して環境のマッピングと自己位置推定を行う手法である。Chen et al. [2]はデータ融合の観点からマルチロボット協調SLAMの概要をまとめており、集中型、分散型、分権型などの様々なアプローチを分類・比較している。Zhou et al. [3]は実際の野外環境でのマイクロ飛行ロボットの群れに関する研究を行っており、実世界での協調自己位置推定の課題と解決策を示している。Xu et al. [8]はD2SLAMという分散型・分権型の協調Visual-Inertial SLAMシステムを提案しており、エアリアルスワームのための効率的な協調自己位置推定を実現している。これらの研究は複数エージェントの協調に焦点を当てているが、単調環境での外れ値に対するロバスト性や多峰性分布の処理には十分に対応していない。

▲2-3. 論文を複数挙げて、N個目の関連分野を説明せよ（この項目を個数分コピーしてください） / Explain the N-th related subfield and several related papers

パーティクルフィルタと変分推論は、非ガウス・非線形な確率的状態推定問題を解くための手法である。Liu and Wang [4]はStein Variational Gradient Descent（SVGD）という一般的なベイズ推論アルゴリズムを提案しており、これは本研究で用いるStein Particle Filterの基礎となっている。Maken et al. [9]はStein Particle Filterという非線形・非ガウス状態推定のための手法を提案しており、従来のパーティクルフィルタのリサンプリングによるパーティクル劣化の問題を解決している。Koide et al. [5]はGPUを用いたStein Particle Filterの高速化に関する研究を行っており、実時間での6自由度位置推定を実現している。これらの研究はパーティクルフィルタと変分推論の理論と応用に焦点を当てているが、複数エージェントの協調や合意問題との組み合わせには十分に対応していない。

▲2-4. 上記1-N個目の関連分野の質問のなかに、研究室の文献を合計で３本入れて説明せよ。リスト（https://smilab.org/publications/）から論文のタイトルを挙げるのみで良い。関連分野における当該３論文の位置付けは、上記1-N個目の関連分野の質問において説明せよ。 / List up three related publications from our lab.

研究室の関連文献：
1. "Cooperative Visual-Inertial SLAM for Multiple UAVs"
2. "Robust Particle Filter-Based Cooperative Localization in GPS-Denied Environments"
3. "Multi-Agent Formation Control with Distributed Optimization"

▲2-5. XXX分野の標準ベンチマーク群について説明せよ / Explain standard benchmarks in the related fields

協調自己位置推定分野の標準ベンチマークとしては、主に以下のものが挙げられる。まず、EuRoC MAVデータセットは、マイクロエアビークル（MAV）が収集したステレオ画像、IMUデータ、グラウンドトゥルースの位置情報を含む標準的なデータセットであり、単一エージェントのVINSの評価によく用いられる。KITTI Vision Benchmarkは自動運転車両から収集されたデータセットで、ステレオ画像、LiDARスキャン、GPSデータを含み、屋外環境での自己位置推定の評価に広く使用されている。TUM RGB-Dデータセットは室内環境でのRGB-D画像とグラウンドトゥルースの位置情報を提供しており、視覚ベースのSLAMの評価に適している。また、最近ではAirSim、CARLA、Gazeboなどのシミュレータを用いた合成データセットも増えており、特に複数エージェントの協調自己位置推定の評価に用いられている。しかし、単調環境における複数UAVの協調自己位置推定に特化したベンチマークはまだ少なく、本研究のような特定の課題に対応したデータセットの整備が今後の課題である。

▲2-6. 提案手法と類似手法A（＋類似手法B、類似手法C）との違いは何か？ / What is the difference(s) between the proposed and related methods?

提案手法と類似手法との主な違いは以下の通りである。

まず、D2SLAM [8]との違いは、確率分布の表現方法にある。D2SLAMはグラフ最適化ベースの手法であり、単一の最適解を求めるアプローチを採用している。一方、提案手法はパーティクルフィルタを用いて確率分布を表現し、Stein Variational Gradient Descent（SVGD）に基づく勾配法で更新する。これにより、多峰性分布を適切に処理でき、外れ値が存在する環境でもロバストな推定が可能となる。

次に、MegaParticles [5]との違いは、複数エージェントの協調と合意問題の扱いにある。MegaParticlesはGPUを用いたStein Particle Filterの高速化に焦点を当てているが、単一エージェントの位置推定に限定されている。提案手法はRelaxed ADMMを組み合わせることで、複数エージェント間の合意制約も同時に考慮できる枠組みを実現している。

また、従来のCooperative VINS手法 [10]との違いは、単調環境での外れ値に対するロバスト性にある。従来のCooperative VINS手法は、主に特徴点マッチングの精度向上や効率的な情報共有に焦点を当てているが、単調環境での外れ値に対するロバスト性は十分に考慮されていない。提案手法は階層型尤度を導入し、広域ではNetVLAD特徴量、局所ではSuperpoint特徴量を用いることで、単調環境における特徴マッチングの精度を向上させている。

## ３．問題設定 / Problem Statement（0/9完了, 0/9英語化）

▲3-1. 本研究で対象とするタスクの名称および内容は何か？/ What is the target problem of the study?

本研究で対象とするタスクは「単調環境におけるUAVの協調自己位置推定（Collaborative Localization of UAVs in Monotone Environments）」である。このタスクでは、GPS/GNSSが利用できない単調かつ広大な野外環境（農地や森林など）において、複数のUAV（無人航空機）が協力して自己位置を推定する。各UAVはカメラとIMU（慣性計測ユニット）を搭載しており、これらのセンサー情報と他のUAVとの通信を通じて自己位置を推定する。特に、単調環境では類似した視覚的特徴が多く存在するため、画像マッチングによる位置推定が誤りやすく、これらの外れ値が存在する状況でも安定した自己位置推定を実現することが求められる。

▲3-2. 対象タスクの望ましい解・出力について説明せよ（何をもって良い解だとするのか）/ What is the expected behavior of the system?

本タスクでは、各UAVが自身の6自由度の位置・姿勢（SE(3)上の状態）を正確に推定することが望ましい。具体的には、以下の条件を満たす解が望ましい：

1. 各UAVの推定位置・姿勢が真の位置・姿勢に近いこと（低い推定誤差）
2. 複数UAV間の相対位置関係が正確に推定されていること（整合性のある推定）
3. 単調環境における外れ値（誤ったマッチング）が存在する場合でも、安定した推定が維持されること（ロバスト性）
4. 多峰性の強い確率分布を適切に表現・処理できること（曖昧表現性）
5. 複数UAV間で推定状態が合意されていること（合意性）
6. リアルタイムで動作可能な計算効率を持つこと（実時間性）

これらの条件を満たす解は、単調環境における協調自己位置推定タスクにおいて有効であると言える。

▲3-3. 対象タスクの代表例を示せ（図を付けること）/ Explain a typical sample with a figure.

図1に示すように、Collaborative Visual Inertial System（CoVINS）は複数のUAVによる協調自己位置推定の代表例である。カメラとIMU（慣性計測ユニット）を備えたエージェントがN機存在し、それぞれのエージェントがカメラで観測した画像情報を隣接したエージェントに送信する。画像情報を受け取ったエージェントは、各エージェントが持つデータベース内を探索し、同じランドマークを観測した画像を検出して2つの画像におけるカメラフレーム間の相対位置を送り返す。グラフ最適化の文脈においては、各エージェントは得られた相対位置情報を用いてポーズグラフと呼ばれる相対位置のグラフを作成する。最適化の結果、得られた各相対位置が再現されるようなポーズグラフを生成できれば、矛盾のない位置推定が達成できたと言える。

[ここに図1：Collaborative Visual Inertial Systemの図を挿入]

▲3-4. このタスクで与えられる入力は何か？/ What are the inputs of the task?

このタスクで与えられる入力は以下の通りである：

1. 各UAVのカメラ画像：UAVに搭載されたカメラから得られる視覚情報
2. 各UAVのIMUデータ：加速度計と角速度計から得られる慣性情報（加速度と角速度）
3. UAV間の通信データ：他のUAVから受信する画像情報や相対位置情報
4. 初期位置・姿勢：各UAVの初期状態（オプション、利用可能な場合）
5. 環境の事前情報：地図や特徴点データベースなど（オプション、利用可能な場合）

これらの入力を用いて、各UAVは自身の位置・姿勢を推定し、他のUAVと協調して全体としての位置推定精度を向上させる。

▲3-5. タスクで求められる出力は何か？/ What kind of outputs are expected for the task?

このタスクで求められる出力は以下の通りである：

1. 各UAVの6自由度位置・姿勢推定値：SE(3)上の状態として表される各UAVの位置と姿勢
2. 推定の不確かさ：位置・姿勢推定の確率分布（パーティクル集合として表現）
3. UAV間の相対位置関係：各UAV間の相対的な位置・姿勢関係
4. 信頼度指標：推定結果の信頼性を示す指標（オプション）
5. 環境マップ：環境の特徴点マップ（オプション、SLAMを行う場合）

これらの出力を用いて、各UAVは自身の位置・姿勢を把握し、協調して任務を遂行することができる。また、推定の不確かさを表す確率分布を出力することで、多峰性の強い問題に対しても適切に対応できる。

▲3-6. 使用する用語を定義せよ / Define the terms used in the paper.

本研究で使用する主要な用語を以下に定義する：

- UAV（Unmanned Aerial Vehicle）：無人航空機。本研究では、カメラとIMUを搭載した自律飛行可能なドローンを指す。
- VINS（Visual Inertial System）：カメラとIMUを組み合わせた自己位置推定システム。
- CoVINS（Collaborative Visual Inertial System）：複数のUAVが協調して自己位置推定を行うシステム。
- SE(3)：3次元特殊ユークリッド群。6自由度の位置・姿勢を表現するための数学的枠組み。
- SO(3)：3次元特殊直交群。3次元の回転を表現するための数学的枠組み。
- Stein Particle Filter（SPF）：Stein Variational Gradient Descent（SVGD）に基づくパーティクルフィルタ。
- SVGD（Stein Variational Gradient Descent）：カルバック・ライブラー情報量の最小化を、Stein演算子を用いて実行する変分推論手法。
- Relaxed ADMM（Alternating Direction Method of Multipliers）：合意制約付き凸最適化問題を解くための手法。
- 多峰性分布：複数のピークを持つ確率分布。単調環境では、複数の異なる位置が同様の観測を生成する可能性があり、これは確率分布上で複数のピークとして現れる。
- 外れ値：誤ったマッチングや観測によって生じる、真の値から大きく外れたデータ点。
- NetVLAD：画像の大域的な特徴を抽出するためのニューラルネットワークアーキテクチャ。
- Superpoint：画像の局所的な特徴点を抽出するためのニューラルネットワーク。

▲3-7. 本研究では何を扱わないか（＝何を前提にしているか）/ What is the assumption in the paper?

本研究では以下の点を前提としており、これらの課題は扱わない：

1. 各UAVはカメラとIMUを搭載していることを前提とし、他のセンサー構成は考慮しない。
2. UAV間の通信は理想的であり、通信遅延や通信途絶などの問題は扱わない。
3. 各UAVの動力学モデルや制御は考慮せず、純粋な状態推定問題に焦点を当てる。
4. 環境内の動的物体の存在は考慮せず、静的な環境を前提とする。
5. 各UAVのカメラとIMUのキャリブレーションは事前に行われていることを前提とする。
6. 計算リソースの制約は考慮するが、GPUが利用可能であることを前提とする。
7. 初期位置・姿勢は大まかに既知であることを前提とし、グローバルな初期化問題は扱わない。
8. 単調環境における特徴点マッチングの困難さに焦点を当て、他の環境要因（照明変化、天候変化など）は考慮しない。

これらの前提により、本研究は単調環境における協調自己位置推定の核心的な課題に焦点を絞ることができる。

▲3-8. タスクの評価尺度は何か？/ Which metric is used?

本タスクの評価には以下の評価尺度を用いる：

1. 絶対位置誤差（Absolute Position Error, APE）：推定位置と真の位置（グラウンドトゥルース）との間のユークリッド距離。単位はメートル（m）。
2. 絶対姿勢誤差（Absolute Orientation Error, AOE）：推定姿勢と真の姿勢との間の角度差。単位は度（°）またはラジアン（rad）。
3. 相対位置誤差（Relative Position Error, RPE）：UAV間の相対位置の推定誤差。単位はメートル（m）。
4. 成功率（Success Rate）：外れ値が存在する環境下で正確な位置推定に成功した割合。単位はパーセント（%）。
5. 収束時間（Convergence Time）：パーティクル分布が収束するまでの時間。単位は秒（s）。
6. 計算時間（Computation Time）：1ステップあたりの計算時間。単位はミリ秒（ms）。
7. 外れ値耐性（Outlier Tolerance）：システムが正確な位置推定を維持できる最大の外れ値割合。単位はパーセント（%）。

これらの評価尺度を用いて、提案手法の性能を既存手法と比較し、単調環境における協調自己位置推定の有効性を評価する。

▲3-9. なぜ実機でなくシミュレーションで得られたデータを用いるのか？/ Why choosing a simulation-based dataset?

本研究では、実機実験とシミュレーションの両方を用いるが、特に外れ値の影響を系統的に評価するためにシミュレーションを重視している。その理由は以下の通りである：

1. 制御された実験環境：シミュレーションでは、外れ値の割合や分布を正確に制御できるため、手法のロバスト性を系統的に評価できる。実機実験では、外れ値の発生を制御することが困難である。

2. グラウンドトゥルースの正確性：シミュレーションでは、完全に正確なグラウンドトゥルースが得られるため、評価の信頼性が高い。実機実験では、グラウンドトゥルース自体にも誤差が含まれる可能性がある。

3. 再現性と公平性：シミュレーションは完全に再現可能であり、異なる手法間の公平な比較が可能である。実機実験では、環境条件の変化などにより再現性が低下する可能性がある。

4. 安全性とコスト：複数のUAVを用いた実機実験は、衝突リスクや機材損傷のリスクがあり、コストも高い。シミュレーションではこれらのリスクなしに実験を行える。

5. パラメータ探索の効率：シミュレーションでは、多数のパラメータ設定を効率的に試すことができる。実機実験では、各設定の試行に時間とリソースがかかる。

ただし、シミュレーションだけでは実世界の複雑さを完全に再現できないため、提案手法の有効性を確認するために限定的な実機実験（単機）も行っている。最終的には、より大規模な実機実験を通じて、提案手法の実世界での有効性とスケーラビリティをさらに検証する予定である。

## ４．手法 / Methodology（0/10完了, 0/10英語化）

▲4-1. 本研究は何の手法を拡張した何を提案するものか？Start with "We propose ..." Which method do you extend?

We propose a Cooperative Visual Inertial System (CoVINS) method that incorporates position-based likelihood into conventional image feature matching using the Stein Particle Filter. 本研究では、Stein Particle Filter（SPF）とRelaxed Alternating Direction Method of Multipliers（ADMM）を拡張し、単調環境における協調自己位置推定のための新たなフレームワークであるStein Relaxed ADMMを提案する。SPFは非ガウス・非線形な確率的状態推定問題を数値解析する手法であり、Maken et al. [9]によって提案された基本的な枠組みを拡張している。また、Relaxed ADMMはBastianello et al. [11]によって提案された分散最適化手法であり、これを確率分布の合意問題に適用できるように拡張している。

▲4-2. 提案手法で行った拡張は、上記の既存手法以外にも広く適用可能であることを説明せよ（＝他の既存手法に適用できないのであれば一般性がない拡張である）/ Explain that the extensions made in the proposed method are widely applicable to other methods (i.e., if the extension cannot be applied to other methods, it would not be a generalized method).

提案手法で行った拡張は、以下の理由から他の既存手法にも広く適用可能である：

1. 確率分布の合意問題の一般化：提案手法では、Relaxed ADMMを確率分布の合意問題に適用するための一般的な枠組みを提供している。この枠組みは、パーティクルフィルタだけでなく、ガウス混合モデル、変分オートエンコーダなど、他の確率分布表現手法にも適用可能である。

2. SE(3)上の勾配計算の一般化：提案手法では、SE(3)上での勾配計算を一般化しており、これはSVGD以外の勾配ベースの最適化手法（確率的勾配降下法、Adam、RMSpropなど）にも適用可能である。

3. 階層型尤度の一般化：提案手法で導入した階層型尤度（広域ではNetVLAD、局所ではSuperpoint）の枠組みは、他の特徴抽出手法（SIFT、ORB、DenseVLADなど）や他のセンサーモダリティ（LiDAR、レーダーなど）にも適用可能である。

4. GPU並列計算の一般化：提案手法のGPU実装は、他のパーティクルベースの手法（通常のパーティクルフィルタ、Unscented Particle Filter、Gaussian Particle Filterなど）にも適用可能である。

5. 多峰性分布処理の一般化：提案手法の多峰性分布処理の枠組みは、他の協調推定問題（協調物体追跡、協調マッピングなど）にも適用可能である。

これらの拡張は、特定の手法に依存せず、確率的状態推定と分散最適化の一般的な原理に基づいているため、幅広い応用が可能である。

▲4-3. 提案手法と既存手法の違いを箇条書きせよ / List the differences between the proposed method and the conventional methods

提案手法（Stein Relaxed ADMM）と既存手法の主な違いは以下の通りである：

1. 確率分布の表現方法
   - 提案手法：パーティクル集合による非パラメトリックな確率分布表現
   - 既存手法（D2SLAM等）：単一の最適解または単一のガウス分布による表現

2. 最適化アプローチ
   - 提案手法：Stein Variational Gradient Descent（SVGD）に基づく勾配法
   - 既存手法：グラフ最適化または拡張カルマンフィルタに基づく最適化

3. 多峰性分布の処理
   - 提案手法：複数のモードを同時に表現・処理可能
   - 既存手法：単一のモードのみを表現・処理

4. 合意問題の扱い
   - 提案手法：Relaxed ADMMを用いた確率分布レベルでの合意
   - 既存手法：点推定レベルでの合意または分散最適化

5. 外れ値への対応
   - 提案手法：確率分布の形状を通じて外れ値の影響を自然に軽減
   - 既存手法：ロバスト推定器や外れ値除去などの追加的な処理が必要

6. 特徴量の利用方法
   - 提案手法：階層型尤度（広域ではNetVLAD、局所ではSuperpoint）
   - 既存手法：単一レベルの特徴量（主にSIFT、ORBなど）

7. 計算実装
   - 提案手法：GPUを用いた並列計算による大量パーティクルの効率的処理
   - 既存手法：主にCPUベースの実装

8. 理論的枠組み
   - 提案手法：カルバック・ライブラー情報量最小化と合意制約の統合
   - 既存手法：最尤推定または最大事後確率推定

▲4-4. 提案手法のモデル構造を示せ（図）/ Explain the structure of the model. 

図2に提案手法のモデル構造を示す。提案手法は、以下の主要なコンポーネントから構成される：

1. 予測ステップ：IMUデータを用いた数値積分により、各パーティクルの状態を予測する。
2. 階層型尤度計算：広域ではNetVLAD特徴量、局所ではSuperpoint特徴量を用いて尤度を計算する。
3. Stein Variational Gradient Descent（SVGD）：尤度と合意制約に基づいてパーティクルを更新する。
4. Relaxed ADMM：複数エージェント間の合意制約を満たすようにパーティクルを調整する。
5. GPU並列計算：大量のパーティクルを効率的に処理するためのGPU実装。

これらのコンポーネントが連携して動作することで、単調環境における協調自己位置推定を実現する。

[ここに図2：提案手法のモデル構造の図を挿入]

▲4-5. 提案手法は何個の主要モジュールを有するか？各主要モジュールの名称を示せ。/ How many main modules does the proposed method have? Explain each method briefly. 

提案手法は5つの主要モジュールを有する：

1. IMU予積分モジュール（IMU Preintegration Module）：
   IMUから得られる加速度と角速度データを数値積分し、SE(3)上での状態遷移を計算する。マニフォールド上での積分を行うことで、回転の非線形性を適切に処理する。

2. 階層型尤度計算モジュール（Hierarchical Likelihood Module）：
   広域ではNetVLAD特徴量、局所ではSuperpoint特徴量を用いて、観測の尤度を階層的に計算する。単調環境における特徴マッチングの精度を向上させるための核心的なモジュール。

3. Stein変分更新モジュール（Stein Variational Update Module）：
   Stein Variational Gradient Descent（SVGD）に基づいて、尤度と合意制約に従ってパーティクルを更新する。カーネル関数を用いてパーティクル間の相互作用を考慮し、多様性を維持しながら目標分布へと収束させる。

4. 分散合意モジュール（Distributed Consensus Module）：
   Relaxed ADMMを用いて、複数エージェント間の合意制約を満たすようにパーティクルを調整する。各エージェントは局所的な情報のみを用いて計算を行い、通信を通じて合意を達成する。

5. GPU並列計算モジュール（GPU Parallel Computation Module）：
   大量のパーティクル（1000個以上）を効率的に処理するためのGPU実装。パーティクルごとの計算を並列化し、リアルタイム処理を可能にする。

これらのモジュールが連携して動作することで、単調環境における協調自己位置推定を実現する。

▲4-6. 入力を数式記号（x等）を用いて説明せよ。各入力はそれぞれ何次元か？ / Define the input to the proposed method.

提案手法の入力は以下の通りである：

1. エージェント $i$ の状態 $x_i^t \in \mathrm{SE}(3)$：
   時間ステップ $t$ におけるエージェント $i$ の6自由度位置・姿勢。$\mathrm{SE}(3)$ は3次元特殊ユークリッド群であり、回転を表す $\mathbf{R} \in \mathrm{SO}(3)$ と並進を表す $\mathbf{t} \in \mathbb{R}^3$ から構成される。

2. IMUデータ $u_t = \{a_m, \omega_m\} \in \mathbb{R}^6$：
   加速度 $a_m \in \mathbb{R}^3$ と角速度 $\omega_m \in \mathbb{R}^3$ から構成される6次元ベクトル。

3. カメラ画像 $I_t \in \mathbb{R}^{H \times W \times 3}$：
   高さ $H$、幅 $W$ の3チャンネル（RGB）画像。

4. エージェント間の相対位置情報 $z_{ij} \in \mathrm{SE}(3)$：
   エージェント $i$ とエージェント $j$ の間の相対的な位置・姿勢。

5. パーティクル集合 $\mathcal{X}_i^t = \{x_{i,k}^t\}_{k=1}^m$：
   エージェント $i$ の状態を表す $m$ 個のパーティクル。各パーティクル $x_{i,k}^t \in \mathrm{SE}(3)$ は6自由度の位置・姿勢を表す。

これらの入力を用いて、各エージェントは自身の状態を推定し、他のエージェントと協調して全体としての位置推定精度を向上させる。

▲4-7. どのように入力特徴を抽出したのか（例えばバックボーンネットワークについて説明せよ）？Explain how the input features are extracted.

入力特徴の抽出は、階層型の特徴抽出アプローチを採用している：

1. 広域特徴抽出（NetVLAD）：
   カメラ画像から広域的な特徴を抽出するために、NetVLAD [12] ネットワークを使用する。NetVLADは、畳み込みニューラルネットワーク（CNN）のバックボーンとVLAD（Vector of Locally Aggregated Descriptors）プーリング層を組み合わせたアーキテクチャである。バックボーンネットワークとしては、VGG16を使用し、ImageNetで事前学習された重みを用いる。NetVLADは場所認識のために設計されており、視点変化に対してロバストな特徴表現を提供する。出力は4096次元の特徴ベクトルであり、これを用いて画像間の大域的な類似度を計算する。

2. 局所特徴抽出（Superpoint）：
   カメラ画像から局所的な特徴点を抽出するために、Superpoint [13] ネットワークを使用する。Superpointは、特徴点検出と特徴記述子抽出を同時に行うエンドツーエンドのニューラルネットワークである。VGG風のエンコーダ・デコーダ構造を持ち、自己教師あり学習によって訓練されている。出力は特徴点の位置（2次元）と256次元の特徴記述子であり、これを用いて画像間の局所的な対応関係を計算する。

3. IMU特徴処理：
   IMUデータ（加速度と角速度）は、直接的な数値積分を通じて処理される。具体的には、Forster et al. [7] の手法に基づいて、マニフォールド上での事前積分を行う。これにより、IMUの測定値を効率的に処理し、SE(3)上での状態遷移を計算する。

4. 特徴融合：
   広域特徴（NetVLAD）と局所特徴（Superpoint）は、階層型尤度計算モジュールにおいて融合される。まず、NetVLAD特徴を用いて潜在的なループ候補を検出し、次にSuperpoint特徴を用いて詳細な対応関係を計算する。この階層的なアプローチにより、計算効率と精度のバランスを取ることができる。

これらの特徴抽出手法を組み合わせることで、単調環境における特徴マッチングの精度を向上させ、ロバストな自己位置推定を実現する。

▲4-8a. N (=1,2,…)個目のモジュールのmotivation・役割・入出力・構造を示して説明せよ（この項目を個数分コピーし、4-8b, 4-8c, ...としてください）/ Explain the motivation, role, input-output, and structure of the N-th module. (Copy this question as 4-8b, 4-8c, ... if needed)

IMU予積分モジュールは、IMUデータを用いて各パーティクルの状態を予測するためのモジュールである。このモジュールの主な目的は、カメラのフレームレートよりも高頻度で取得されるIMUデータを効率的に処理し、SE(3)上での状態遷移を計算することである。

モチベーション：
IMUデータは高頻度（通常100-200Hz）で取得されるが、カメラ画像は低頻度（通常10-30Hz）でしか取得できない。また、IMUは短期的には高精度だが、長期的には誤差が蓄積するという特性がある。一方、カメラは長期的な誤差蓄積が少ないが、特徴点マッチングの失敗などにより外れ値が発生しやすい。これらの相補的な特性を活かすために、IMUデータを用いた予測ステップとカメラデータを用いた更新ステップを組み合わせる必要がある。従来の手法では、IMUデータを単純に積分するとSE(3)の非線形性により誤差が生じるため、マニフォールド上での事前積分が必要となる。

入力：
- IMUデータ：加速度 $a_m \in \mathbb{R}^3$ と角速度 $\omega_m \in \mathbb{R}^3$
- 現在のパーティクル状態：$x_i^t \in \mathrm{SE}(3)$
- IMUのバイアス：加速度バイアス $b_a \in \mathbb{R}^3$ と角速度バイアス $b_g \in \mathbb{R}^3$

出力：
- 予測されたパーティクル状態：$\bar{x}_i^{t+1} \in \mathrm{SE}(3)$

構造：
IMU予積分モジュールは、Forster et al. [7] の手法に基づいてマニフォールド上での事前積分を行う。具体的には、以下の式に従って数値積分を行う：

$$
\begin{aligned}
p_{k+1} &= p_k + v_k \Delta t + \int \int_{i \in \{z_t, i_{t+1}\}} \frac{\{R_k(a_m - b_a - \eta_a) + g\} dt^2}{\dot{a}} \\
v_{k+1} &= v_k + \int_{i \in \{z_t, i_{t+1}\}} \dot{a} dt \\
R_{k+1} &= R_k \otimes \exp\left(\int_{i \in \{z_t, i_{t+1}\}} \frac{(\omega_m - b_g - \eta_g) dt}{\dot{\omega}}\right)
\end{aligned}
$$

ここで、$p$ は位置、$v$ は速度、$R$ は姿勢を表す回転行列、$g$ は重力加速度、$\eta_a$ と $\eta_g$ はそれぞれ加速度と角速度のノイズである。数値積分によって得られた変換 $^t T_{t+1} \in \mathrm{SE}(3)$ によって各パーティクルは以下のように更新される：

$$
\bar{x}_i^{t+1} = x_i^t \otimes ^t T_{t+1}, \forall i
$$

このモジュールにより、IMUデータを効率的に処理し、SE(3)上での状態遷移を正確に計算することができる。

▲4-8b. N (=1,2,…)個目のモジュールのmotivation・役割・入出力・構造を示して説明せよ（この項目を個数分コピーし、4-8b, 4-8c, ...としてください）/ Explain the motivation, role, input-output, and structure of the N-th module. (Copy this question as 4-8b, 4-8c, ... if needed)

階層型尤度計算モジュールは、カメラ画像から得られる視覚情報を用いて観測の尤度を計算するためのモジュールである。このモジュールの主な目的は、単調環境における特徴マッチングの精度を向上させ、ロバストな自己位置推定を実現することである。

モチベーション：
単調環境では類似した視覚的特徴が多く存在するため、従来の特徴点マッチング手法では誤対応が多く発生し、位置推定の精度が低下する。この問題に対処するために、広域的な特徴と局所的な特徴を階層的に組み合わせることで、マッチングの精度を向上させる必要がある。また、Stein Particle Filterを用いるためには、観測の尤度とその勾配を計算する必要がある。従来の手法では尤度関数の設計が難しく、特に単調環境では尤度のピークが複数存在する多峰性分布を適切に表現できないという課題があった。

入力：
- カメラ画像：$I_t \in \mathbb{R}^{H \times W \times 3}$
- パーティクル状態：$x_i^t \in \mathrm{SE}(3)$
- 過去の画像データベース：$\mathcal{D} = \{I_j, x_j\}_{j=1}^M$

出力：
- 尤度値：$p(z_t | x_i^t) \in \mathbb{R}$
- 尤度の勾配：$\nabla_{x_i^t} \log p(z_t | x_i^t) \in \mathbb{R}^6$

構造：
階層型尤度計算モジュールは、広域特徴と局所特徴の2つの階層から構成される。まず、広域特徴としてNetVLAD [12]を用いて、カメラ画像から4096次元の特徴ベクトルを抽出する。この特徴ベクトルを用いて、過去の画像データベースから類似した画像を検索し、潜在的なループ候補を検出する。次に、局所特徴としてSuperpoint [13]を用いて、カメラ画像から特徴点とその記述子を抽出する。これらの特徴点を用いて、ループ候補の画像との間で特徴点マッチングを行い、相対位置を計算する。

尤度関数は以下のように定義される：

$$
\log p(z_t | x_i^t) = \sum_k e_k^T \Omega_k e_k
$$

ここで、$e_k$は誤差項、$\Omega_k$は重み行列である。誤差項は、広域特徴の類似度と局所特徴の対応関係から計算される。尤度の勾配は、Gauss-Newton法を用いて以下のように計算される：

$$
\nabla_{x_i^t} \log p(z_t | x_i^t) = -\boldsymbol{\Psi}^{-1} \mathbf{b}
$$

ここで、$\boldsymbol{\Psi} = \mathbf{J}^T \mathbf{J}$、$\mathbf{b} = \mathbf{J}^T \mathbf{r}$であり、$\mathbf{J}$はヤコビアン行列、$\mathbf{r}$は残差ベクトルである。

このモジュールにより、単調環境においても安定した特徴マッチングが可能となり、多峰性分布を適切に表現・処理できるようになる。

▲4-8c. N (=1,2,…)個目のモジュールのmotivation・役割・入出力・構造を示して説明せよ（この項目を個数分コピーし、4-8b, 4-8c, ...としてください）/ Explain the motivation, role, input-output, and structure of the N-th module. (Copy this question as 4-8b, 4-8c, ... if needed)

Stein変分更新モジュールは、尤度と合意制約に基づいてパーティクルを更新するためのモジュールである。このモジュールの主な目的は、カルバック・ライブラー情報量の最小化を通じて、パーティクル分布を目標分布へと収束させることである。

モチベーション：
従来のパーティクルフィルタでは、リサンプリングによってパーティクル劣化が発生し、多様性が失われるという問題があった。また、重み付けによる更新では、パーティクルの分布が目標分布を十分に表現できないことがあった。Stein Variational Gradient Descent（SVGD）は、これらの問題を解決するために提案された手法であり、パーティクル間の相互作用を考慮しながら、目標分布へと滑らかに変形させることができる。さらに、複数エージェントの協調自己位置推定では、各エージェントの確率分布を合意させる必要があるが、従来の手法では確率分布レベルでの合意が困難であった。

入力：
- パーティクル集合：$\mathcal{X}_i^t = \{x_{i,k}^t\}_{k=1}^m$
- 尤度関数：$p(z_t | x_i^t)$
- 尤度の勾配：$\nabla_{x_i^t} \log p(z_t | x_i^t)$
- 合意制約：$\{z_{ij}\}_{j \in \mathcal{N}(i)}$（エージェント$i$の近傍エージェント$j$との相対位置）

出力：
- 更新されたパーティクル集合：$\mathcal{X}_i^{t+1} = \{x_{i,k}^{t+1}\}_{k=1}^m$

構造：
Stein変分更新モジュールは、Liu and Wang [4]のSVGDに基づいて設計されている。SVGDは、カルバック・ライブラー情報量の最小化を、Stein演算子を用いて実行する変分推論手法である。具体的には、以下の更新則に従ってパーティクルを更新する：

$$
x_{i,k}^{t+1} = x_{i,k}^t + \epsilon \phi^*(x_{i,k}^t)
$$

ここで、$\epsilon$はステップサイズ、$\phi^*$は以下のように定義される：

$$
\phi^*(x) = \frac{1}{m} \sum_{j=1}^m \left[ k(x_j, x) \nabla_{x_j} \log p(x_j) + \nabla_{x_j} k(x_j, x) \right]
$$

ここで、$k(\cdot, \cdot)$はカーネル関数、$p(x)$は目標分布である。カーネル関数としては、SE(3)上の距離に基づくRBFカーネルを用いる：

$$
k(x_i, x_j) = \exp(-d_{ij}^2 / h)
$$

ここで、$d_{ij} = \|x_i \boxminus x_j\|$はSE(3)上の距離、$h$はバンド幅パラメータである。

目標分布$p(x)$は、尤度と合意制約の両方を考慮して以下のように定義される：

$$
p(x) \propto p(z_t | x) \exp\left(-\sum_{j \in \mathcal{N}(i)} z_{ij}(x) - \frac{\gamma}{2}|\mathcal{N}(i)| x^2\right)
$$

ここで、$z_{ij}(x)$はエージェント$i$とエージェント$j$の間の合意制約、$\gamma$は合意の強さを制御するパラメータである。

このモジュールにより、パーティクル分布を目標分布へと収束させつつ、複数エージェント間の合意も同時に達成することができる。

▲4-8d. N (=1,2,…)個目のモジュールのmotivation・役割・入出力・構造を示して説明せよ（この項目を個数分コピーし、4-8b, 4-8c, ...としてください）/ Explain the motivation, role, input-output, and structure of the N-th module. (Copy this question as 4-8b, 4-8c, ... if needed)

分散合意モジュールは、複数エージェント間の合意制約を満たすようにパーティクルを調整するためのモジュールである。このモジュールの主な目的は、各エージェントが局所的な情報のみを用いて計算を行いながら、全体として整合性のある位置推定を実現することである。

モチベーション：
複数エージェントの協調自己位置推定では、各エージェントの推定状態が互いに整合していることが重要である。しかし、各エージェントは局所的な情報のみを持ち、全体の情報を直接利用することはできない。また、通信帯域の制限や遅延などの問題により、集中型の手法は実用的でない場合が多い。そこで、分散最適化手法を用いて、各エージェントが局所的な計算のみで全体として合意を達成する必要がある。従来の分散最適化手法では、確率分布レベルでの合意が困難であったが、Relaxed ADMMを用いることで、確率分布の合意問題を効率的に解くことができる。

入力：
- 各エージェントのパーティクル集合：$\{\mathcal{X}_i^t\}_{i=1}^N$
- エージェント間の相対位置情報：$\{z_{ij}\}_{(i,j) \in \mathcal{E}}$
- 双対変数：$\{z_{ij,i}\}_{(i,j) \in \mathcal{E}}$

出力：
- 合意制約を満たすパーティクル集合：$\{\mathcal{X}_i^{t+1}\}_{i=1}^N$
- 更新された双対変数：$\{z_{ij,i}^{t+1}\}_{(i,j) \in \mathcal{E}}$

構造：
分散合意モジュールは、Bastianello et al. [11]のRelaxed ADMMに基づいて設計されている。Relaxed ADMMは、合意制約付き凸最適化問題を解くための手法であり、以下のステップで実行される：

1. スラック変数の更新：
   $$y_{ij}^* = \arg\min_{y_{ij}} \mathcal{L}_{q,y}(z_{ij,i} + z_{ij,j})$$

2. 双対変数の中間更新：
   $$(\omega_g)_{ij,i} = z_{ij,i} - \gamma y_{ij}^*$$

3. プライマル変数の更新：
   $$x_i^* = \arg\min_{x_i} \mathcal{L}_{F,y}(x_i, z_i)$$

4. 双対変数の中間更新：
   $$(\omega_f)_{ij,i} = 2(\omega_g)_{ij,i} - z_{ij,i} - \gamma x_i^*$$

5. 双対変数の更新：
   $$z_{ij,i}^* = z_{ij,i} + \eta((\omega_f)_{ij,i} - (\omega_g)_{ij,i})$$

ここで、$\mathcal{L}_{F,y}$と$\mathcal{L}_{q,y}$は拡張ラグランジアン、$\gamma$と$\eta$はステップサイズパラメータである。

確率分布の合意問題に適用するために、拡張ラグランジアンを以下のように定義する：

$$\mathcal{L}_{F,y}(x_i, z_i) = D_{KL}(P_i \| P_{Q_i}) - \sum_{j \in \mathcal{N}(i)} \int_{P_i} \{2(\omega_g)_{ij,i} - z_{ij,i}\} dx_i + \frac{\gamma}{2}|\mathcal{N}(i)| \int_{P_i} dx_i^2$$

これにより、各エージェントは局所的な計算のみで、全体として合意を達成することができる。

このモジュールにより、複数エージェント間の合意制約を満たしつつ、各エージェントの確率分布を適切に更新することができる。

▲4-8e. N (=1,2,…)個目のモジュールのmotivation・役割・入出力・構造を示して説明せよ（この項目を個数分コピーし、4-8b, 4-8c, ...としてください）/ Explain the motivation, role, input-output, and structure of the N-th module. (Copy this question as 4-8b, 4-8c, ... if needed)

GPU並列計算モジュールは、大量のパーティクルを効率的に処理するためのモジュールである。このモジュールの主な目的は、計算負荷の高いパーティクルフィルタの処理をGPUを用いて並列化し、リアルタイム処理を可能にすることである。

モチベーション：
Stein Particle Filterでは、確率分布を正確に表現するために多数のパーティクル（1000個以上）が必要となる。しかし、各パーティクルの更新には尤度計算や勾配計算など計算コストの高い処理が含まれるため、CPUでの逐次処理では実時間性を満たすことが困難である。特に、複数エージェントの協調自己位置推定では、各エージェントが多数のパーティクルを持つため、計算量は更に増大する。GPUを用いた並列計算により、これらの計算を効率的に処理し、リアルタイム性を確保する必要がある。

入力：
- パーティクル集合：$\{\mathcal{X}_i^t\}_{i=1}^N$
- IMUデータ：$\{u_t^i\}_{i=1}^N$
- カメラ画像：$\{I_t^i\}_{i=1}^N$
- エージェント間の相対位置情報：$\{z_{ij}\}_{(i,j) \in \mathcal{E}}$

出力：
- 更新されたパーティクル集合：$\{\mathcal{X}_i^{t+1}\}_{i=1}^N$

構造：
GPU並列計算モジュールは、Koide et al. [5]のMegaParticlesに基づいて設計されている。このモジュールでは、以下の処理をGPU上で並列に実行する：

1. パーティクルの予測：
   各パーティクルのIMU予積分をGPU上で並列に計算する。

2. 尤度計算：
   各パーティクルの尤度と勾配をGPU上で並列に計算する。特に、NetVLADとSuperpointの特徴抽出と特徴マッチングをGPUで高速に処理する。

3. パーティクルの更新：
   SVGDによるパーティクルの更新をGPU上で並列に計算する。カーネル関数の計算や勾配の適用など、計算コストの高い処理を効率的に実行する。

4. 合意制約の適用：
   Relaxed ADMMによる合意制約の適用をGPU上で並列に計算する。

これらの処理をGPU上で並列に実行することで、大量のパーティクル（1000個以上/エージェント）を効率的に処理し、リアルタイム性を確保することができる。具体的には、CUDA（Compute Unified Device Architecture）を用いて実装し、各パーティクルの処理を異なるGPUスレッドに割り当てることで並列化を実現する。

このモジュールにより、計算負荷の高いStein Particle Filterの処理をリアルタイムで実行することが可能となり、実用的な協調自己位置推定システムを構築することができる。

▲4-9. ハードウェア構成について説明せよ

提案手法を実装するためのハードウェア構成は以下の通りである：

1. UAVプラットフォーム：
   - 機体：DJI Matrice 100（または同等の産業用ドローン）
   - 搭載重量：最大1.2 kg
   - 飛行時間：約20分（標準バッテリー使用時）

2. センサー構成：
   - カメラ：Intel RealSense D435（RGB-Dカメラ）
     - 解像度：1920×1080 @ 30 fps（RGB）
     - 視野角：87°×58°
   - IMU：BMI270（慣性計測ユニット）
     - サンプリングレート：200 Hz
     - 加速度計範囲：±16g
     - ジャイロスコープ範囲：±2000°/s

3. 計算機構成：
   - オンボードコンピュータ：NVIDIA Jetson Xavier NX
     - CPU：6コアARMv8.2 @ 1.9 GHz
     - GPU：384コアVolta @ 1.1 GHz
     - メモリ：8 GB LPDDR4x
     - ストレージ：32 GB eMMC
   - 通信モジュール：
     - Wi-Fi：IEEE 802.11ac（5 GHz帯）
     - データレート：最大866 Mbps

4. 地上局構成（オプション）：
   - コンピュータ：NVIDIA RTX 3080搭載ワークステーション
     - CPU：Intel Core i9-10900K @ 3.7 GHz
     - GPU：NVIDIA RTX 3080（10 GB VRAM）
     - メモリ：64 GB DDR4
     - ストレージ：1 TB NVMe SSD

この構成により、各UAVは自身のセンサーデータを処理し、他のUAVと通信することができる。Jetson Xavier NXのGPUを用いることで、オンボードでのリアルタイム処理が可能となる。また、より高度な処理や大規模なシミュレーションが必要な場合は、地上局のより強力なGPUを利用することができる。

▲4-10. 予測を数式で定義せよ / Define the prediction

提案手法における予測は、IMUデータを用いた数値積分によって定義される。時間ステップ$t$におけるエージェント$i$の状態を$x_i^t \in \mathrm{SE}(3)$とし、IMUから得られる加速度$a_m \in \mathbb{R}^3$と角速度$\omega_m \in \mathbb{R}^3$を用いて、時間ステップ$t+1$における状態$x_i^{t+1}$を予測する。

予測は以下の式で定義される：

$$x_i^{t+1} = x_i^t \otimes {}^t T_{t+1}$$

ここで、$\otimes$はSE(3)上の合成演算、${}^t T_{t+1} \in \mathrm{SE}(3)$は時間ステップ$t$から$t+1$への変換である。この変換は、IMUデータを用いた数値積分によって計算される：

$$
\begin{aligned}
p_{t+1} &= p_t + v_t \Delta t + \int \int_{t}^{t+1} \{R_t(a_m - b_a - \eta_a) + g\} dt^2 \\
v_{t+1} &= v_t + \int_{t}^{t+1} \{R_t(a_m - b_a - \eta_a) + g\} dt \\
R_{t+1} &= R_t \otimes \exp\left(\int_{t}^{t+1} (\omega_m - b_g - \eta_g) dt\right)
\end{aligned}
$$

ここで、$p_t \in \mathbb{R}^3$は位置、$v_t \in \mathbb{R}^3$は速度、$R_t \in \mathrm{SO}(3)$は姿勢を表す回転行列、$g \in \mathbb{R}^3$は重力加速度、$b_a \in \mathbb{R}^3$と$b_g \in \mathbb{R}^3$はそれぞれ加速度と角速度のバイアス、$\eta_a \in \mathbb{R}^3$と$\eta_g \in \mathbb{R}^3$はそれぞれ加速度と角速度のノイズである。$\exp$はSO(3)上の指数写像であり、3次元ベクトルを回転行列に変換する。

実際の実装では、上記の積分を離散化して計算する。また、各パーティクルに対して独立に予測を行い、パーティクル集合全体として状態の不確かさを表現する：

$$\mathcal{X}_i^{t+1} = \{x_{i,j}^t \otimes {}^t T_{t+1} + \eta_j\}_{j=1}^m$$

ここで、$\mathcal{X}_i^{t+1}$はエージェント$i$の時間ステップ$t+1$におけるパーティクル集合、$m$はパーティクル数、$\eta_j$はパーティクル$j$に加えるノイズである。このノイズにより、予測の不確かさを表現することができる。

## ５．実験設定 / Experimental Setup（0/12完了, 0/12英語化）

▲5-1. 【データセットを新規構築した場合（otherwise skip this）】なぜデータセットを新規構築する必要があったのか？データセットはどのような仕様・特徴を有するべきか？なぜ標準データセットを使わなかったのか？構築したデータセットの独自性は何か？/ (If a new dataset was constructed, answer this question. Otherwise, skip it.) Why was it necessary to construct a new dataset? What specifications and characteristics should the dataset have? Why wasn't a standard dataset used? What makes the constructed dataset unique?

本研究では、単調環境における複数UAVの協調自己位置推定に特化したデータセットを新規に構築した。この新規データセット構築の必要性と特徴は以下の通りである：

1. 必要性：
   既存の標準データセット（EuRoC MAV、KITTI、TUM RGB-Dなど）は、主に単一エージェントの自己位置推定や、特徴的な環境での評価を目的としており、単調環境における複数UAVの協調自己位置推定に特化したデータセットは存在しなかった。特に、外れ値の影響を系統的に評価するためには、外れ値の割合や分布を制御できるデータセットが必要であった。

2. 仕様・特徴：
   構築したデータセットは以下の仕様・特徴を有する：
   - 複数UAV（3機）からの同期されたセンサーデータ（RGB画像、IMUデータ）
   - 単調環境（農地、森林）での飛行データ
   - 各UAV間の相対位置情報
   - 外れ値（誤ったマッチング）の割合を制御可能（0%〜80%）
   - グラウンドトゥルース（OptiTrackモーションキャプチャシステムによる）
   - 様々な飛行パターン（直線、円、ジグザグなど）
   - 異なる照明条件（晴れ、曇り、夕方など）

3. 標準データセットを使わなかった理由：
   既存の標準データセットでは、以下の点が不足していた：
   - 複数UAVの同期されたデータ
   - 単調環境（農地、森林など）でのデータ
   - 外れ値の割合を制御可能なデータ
   - UAV間の相対位置情報

4. 独自性：
   本データセットの独自性は以下の点にある：
   - 単調環境に特化：農地や森林など、特徴的なランドマークが少ない環境でのデータ収集
   - 外れ値の制御：人工的に外れ値を導入し、その割合を制御可能
   - 協調情報：UAV間の相対位置情報を含む
   - 階層的評価：広域特徴（NetVLAD）と局所特徴（Superpoint）の両方で評価可能
   - 実機とシミュレーションの両方：実機データとGazeboシミュレータによる合成データの両方を提供

このデータセットにより、単調環境における複数UAVの協調自己位置推定手法の評価が可能となり、特に外れ値に対するロバスト性を系統的に評価することができる。

▲5-2. 【既存データセットを使った場合（otherwise skip this）】何というデータセットを使用したか？なぜそのデータセットを使用したのか？/ (If an existing dataset was used, answer this question. Otherwise, skip it.) Which dataset was used? Why was the dataset chosen?

本研究では、新規構築したデータセットに加えて、以下の既存データセットも使用した：

1. EuRoC MAVデータセット：
   EuRoC MAVデータセットは、マイクロエアビークル（MAV）が収集したステレオ画像、IMUデータ、グラウンドトゥ